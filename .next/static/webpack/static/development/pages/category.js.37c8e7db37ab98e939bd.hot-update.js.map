{"version":3,"file":"static/webpack/static/development/pages/category.js.37c8e7db37ab98e939bd.hot-update.js","sources":["webpack:///./components/admin/manageProfiles.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport Login from \"../login/login\";\nimport Nav from \"../nav\";\nimport {\n  Row,\n  Col,\n  Card,\n  Form,\n  Input,\n  Button,\n  Checkbox,\n  Select,\n  InputNumber,\n  Upload,\n  Icon,\n  List,\n  Skeleton,\n  Radio\n} from \"antd\";\nimport Router from \"next/router\";\nimport Link from \"next/link\";\nimport fetch from \"isomorphic-unfetch\";\nimport axios from \"axios\";\nimport reqwest from \"reqwest\";\nimport { withRouter } from \"next/router\";\n\nimport { storage } from \"../../firebase\";\nconst { TextArea } = Input;\n\nclass AdminManageProfile extends Component {\n  state = {\n    categories: [],\n    locations: [],\n    budgetBracket: 0,\n    profiles: [],\n    profile: { videos: [] },\n    initLoading: true,\n    count: 0,\n    loading: false,\n    profileMode: \"create\",\n    imageUrl: [],\n    portfolioImages: []\n  };\n\n  componentDidMount() {\n    this.getData(res => {\n      this.setState({\n        initLoading: false,\n        profiles: res,\n        count: this.state.count + 2\n      });\n    });\n    if (this.props.profile !== {}) {\n      //   Router.push(\"/dashboard\");\n    }\n    axios.get(\"/api/categories/allCategories/7/0\").then(categories => {\n      this.setState({ categories: categories.data });\n    });\n\n    axios\n      .get(\"/api/admin/getLocations\")\n      .then(loc => this.setState({ locations: loc.data[0].locations }));\n  }\n  componentWillMount() {\n    // this.setState({ categories, locations: locations[0].locations });\n  }\n  getData = callback => {\n    axios\n      .get(`/api/profiles/allProfiles/2/${this.state.count}`)\n      .then(res => callback(res.data));\n  };\n  onLoadMore = () => {\n    this.setState({\n      loading: true,\n      count: this.state.count + 2\n    });\n    this.getData(res => {\n      const profiles = this.state.profiles.concat(res);\n      this.setState(\n        {\n          profiles,\n          loading: false\n        },\n        () => {\n          // Resetting window's offsetTop so as to display react-virtualized demo underfloor.\n          // In real scene, you can using public method of react-virtualized:\n          // https://stackoverflow.com/questions/46700726/how-to-use-public-method-updateposition-of-react-virtualized\n          window.dispatchEvent(new Event(\"resize\"));\n        }\n      );\n    });\n  };\n\n  openProfileDrawer = id => {\n    this.setState({\n      drawerVisible: true,\n      currentId: id,\n      profileMode: \"update\"\n    });\n\n    axios.get(\"/api/profiles/adminCurrentProfile/\" + id).then(profile => {\n      this.setState({ profile: profile.data });\n\n      this.setState({ imageUrl: profile.data.images });\n      this.setState({ portfolioImages: [] });\n    });\n  };\n  onChangeBudgetBracket = value => {\n    this.setState({\n      budgetBracket: value\n    });\n  };\n  artistServices = categories => {\n    const index = categories.findIndex(x => x.name === \"Artist\");\n\n    <Form.Item label=\"Artist Sub Category\" {...Layout}>\n      {getFieldDecorator(\"artistSubCategory\", {\n        initialValue: profile.artistSubCategory\n      })(\n        <Radio.Group buttonStyle=\"solid\">\n          {this.state.categories[index].servicesRequired.map(service => (\n            <Radio.Button key={service} value={service} checked=\"true\">\n              {service}\n            </Radio.Button>\n          ))}\n        </Radio.Group>\n      )}\n    </Form.Item>;\n  };\n  normFile = e => {\n    const file = e.file;\n    this.setState({ portfolioImages: this.state.portfolioImages.concat(file) });\n  };\n  handleSubmit = e => {\n    e.preventDefault();\n    this.props.form.validateFields((err, values) => {\n      console.log(values);\n      if (!err) {\n        let request = {\n          values: values,\n          mode: this.state.profileMode\n        };\n        axios.post(\"/api/admin/adminManageProfile\", request).then(profile => {\n          const index = this.state.profiles.findIndex(\n            x => x._id === this.state.profile._id\n          );\n\n          (this.state.profiles[index] = profile.data),\n            this.setState({\n              profile: profile.data\n            });\n          this.state.portfolioImages.map(image => {\n            const upload = storage\n              .ref(`/vendorImages/${image.name}`)\n              .put(image.originFileObj);\n            upload.on(\n              \"state_changed\",\n              snapshot => {\n                console.log(\"progress\");\n              },\n              error => {\n                console.log(\"error\");\n              },\n              () => {\n                storage\n                  .ref(\"vendorImages\")\n                  .child(image.name)\n                  .getDownloadURL()\n                  .then(url => {\n                    let temp = { original: url, thumbnail: url };\n                    this.setState({\n                      imageUrl: this.state.imageUrl.concat(temp)\n                    });\n                    axios.post(\n                      `/api/profiles/addImages/${profile.data._id}`,\n                      this.state.imageUrl\n                    );\n                  });\n              }\n            );\n          });\n        });\n      }\n    });\n  };\n  render() {\n    const { getFieldDecorator } = this.props.form;\n\n    const formItemLayoutHorizontal = {\n      labelCol: { span: 6 },\n      wrapperCol: { span: 16 }\n    };\n    const tailformItemLayout = {\n      wrapperCol: {\n        xs: {\n          span: 24,\n          offset: 0\n        }\n      }\n    };\n    const formItemLayoutVertical = {\n      wrapperCol: { span: 22, offset: 1 }\n    };\n    let Layout, layoutVariable;\n    if (typeof screen !== \"undefined\") {\n      Layout =\n        screen.width <= \"850\"\n          ? formItemLayoutVertical\n          : formItemLayoutHorizontal;\n      layoutVariable = screen.width <= \"850\" ? \"vertical\" : \"horizontal\";\n    } else {\n      Layout = formItemLayoutHorizontal;\n      layoutVariable = \"horizontal\";\n    }\n    const {\n      categories,\n      locations,\n      profiles,\n      profile,\n      initLoading,\n      loading\n    } = this.state;\n    const loadMore =\n      !initLoading && !loading ? (\n        <div\n          style={{\n            textAlign: \"center\",\n            marginTop: 12,\n            height: 32,\n            lineHeight: \"32px\"\n          }}\n        >\n          <Button onClick={this.onLoadMore}>Load more</Button>\n        </div>\n      ) : null;\n    typeof profile.user !== \"undefined\"\n      ? null\n      : (profile.user = { name: \"\", email: \"\", mobile: \"\" });\n    return (\n      <React.Fragment>\n        <h1 style={{ textAlign: \"center\" }}>Create or Update Profile</h1>\n        <Form onSubmit={this.handleSubmit} layout={layoutVariable}>\n          <Form.Item {...Layout} label=\"Company Name\">\n            {getFieldDecorator(\n              \"companyName\",\n              { initialValue: profile.companyName },\n              {\n                rules: [\n                  {\n                    required: true,\n                    message: \"Please input your Company Name!\"\n                  }\n                ]\n              }\n            )(<Input placeholder=\"Business Name\" />)}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"Description\">\n            {getFieldDecorator(\n              \"description\",\n              { initialValue: profile.description },\n              {}\n            )(\n              <TextArea\n                placeholder=\"Provide details about your business\"\n                autosize\n              />\n            )}\n            <div style={{ margin: \"24px 0\" }} />\n          </Form.Item>\n          <Form.Item {...Layout} label=\"Choose Categories\">\n            {getFieldDecorator(\"categories\", {\n              initialValue: profile.categories\n            })(\n              <Checkbox.Group style={{ width: \"100%\" }}>\n                <Row>\n                  {categories.map(category => (\n                    <Col\n                      lg={{ span: 6 }}\n                      md={{ span: 8 }}\n                      sm={{ span: 24 }}\n                      key={category.name}\n                    >\n                      <Checkbox value={category.name}>{category.name}</Checkbox>\n                    </Col>\n                  ))}\n                </Row>\n              </Checkbox.Group>\n            )}\n          </Form.Item>\n\n          <Form.Item {...Layout} label=\"Choose Locations\">\n            {getFieldDecorator(\"locations\", {\n              initialValue: profile.locations\n            })(\n              <Checkbox.Group style={{ width: \"100%\" }}>\n                <Row>\n                  {locations.map(location => (\n                    <Col\n                      lg={{ span: 6 }}\n                      md={{ span: 8 }}\n                      sm={{ span: 24 }}\n                      key={location}\n                    >\n                      <Checkbox value={location}>{location}</Checkbox>\n                    </Col>\n                  ))}\n                </Row>\n              </Checkbox.Group>\n            )}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"Choose Primary Location\">\n            {getFieldDecorator(\"primaryLocation\", {\n              initialValue: profile.primaryLocation\n                ? profile.primaryLocation\n                : \"Chennai\"\n            })(\n              <Select size=\"large\" style={{ width: 180 }}>\n                {locations.map(location => (\n                  <Option key={location}>{location}</Option>\n                ))}\n              </Select>\n            )}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"Minimum Budget\">\n            {getFieldDecorator(\n              \"budgetBracket\",\n              { initialValue: profile.budgetBracket },\n              {\n                value:\n                  typeof this.state.budgetBracket === \"number\"\n                    ? this.state.budgetBracket\n                    : 0\n              }\n            )(<InputNumber onChange={this.onChangeBudgetBracket} />)}\n          </Form.Item>\n          <Form.Item\n            {...Layout}\n            label=\"Portfolio Images\"\n            extra=\"Our customers will get a fair idea about your quality and design\"\n          >\n            {getFieldDecorator(\"images\", {\n              valuePropName: \"fileList\",\n              getValueFromEvent: this.normFile\n            })(\n              <Upload name=\"logo\" listType=\"picture\" multiple={true}>\n                <Button>\n                  <Icon type=\"upload\" /> Click to upload\n                </Button>\n              </Upload>\n            )}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"Youtube videos\">\n            {getFieldDecorator(\n              \"videos\",\n              { initialValue: profile.videos.join(\",\") },\n              {}\n            )(\n              <TextArea\n                placeholder={`Provide youtube urls seperated by comma ${\"\\n\"}ex., https://www.youtube.com/watch?v=7GBCHRxq3Sc,https://www.youtube.com/watch?v=VRdaHFy0FcY`}\n              />\n            )}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"User Name\">\n            {getFieldDecorator(\"name\", {\n              initialValue: profile.user.name\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"User Mobile\">\n            {getFieldDecorator(\"mobile\", {\n              initialValue: profile.user.mobile\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"User Email\">\n            {getFieldDecorator(\"email\", {\n              initialValue: profile.user.email\n            })(<Input />)}\n          </Form.Item>\n\n          <Form.Item label=\"Authorized\" {...Layout}>\n            {getFieldDecorator(\"isAuthorized\", {\n              initialValue: profile.isAuthorized\n            })(\n              <Radio.Group buttonStyle=\"solid\">\n                <Radio.Button value={true}>Authorized</Radio.Button>\n                <Radio.Button value={false}>Not Authorized</Radio.Button>\n              </Radio.Group>\n            )}\n          </Form.Item>\n          <Form.Item label=\"Add to Homescreen\" {...Layout}>\n            {getFieldDecorator(\"addToHome\", {\n              initialValue: profile.addToHome\n            })(\n              <Radio.Group buttonStyle=\"solid\">\n                <Radio.Button value={true}>Yes</Radio.Button>\n                <Radio.Button value={false}>No</Radio.Button>\n              </Radio.Group>\n            )}\n          </Form.Item>\n          <Form.Item {...Layout} label=\"Artist Order\">\n            {getFieldDecorator(\"artistOrder\", {\n              initialValue: profile.artistOrder\n            })(<InputNumber />)}\n          </Form.Item>\n          {() => this.artistServices(this.state.categories)}\n          <div style={{ textAlign: \"center\" }}>\n            <Form.Item {...tailformItemLayout}>\n              <Button type=\"primary\" htmlType=\"submit\">\n                Add/Update Profile\n              </Button>\n            </Form.Item>\n            {this.state.profileMode === \"update\" ? (\n              <Form.Item {...tailformItemLayout}>\n                <Link href={\"/profile?profileId=\" + profile.slug} prefetch>\n                  <a target=\"_blank\">\n                    <Button type=\"primary\">View Profile</Button>\n                  </a>\n                </Link>\n              </Form.Item>\n            ) : null}\n          </div>\n        </Form>\n        <div style={{ background: \"#ECECEC\", padding: \"30px\" }}>\n          <h1 style={{ textAlign: \"center\" }}>All Profiles</h1>\n          <List\n            className=\"demo-loadmore-list\"\n            loading={initLoading}\n            itemLayout=\"horizontal\"\n            loadMore={loadMore}\n            dataSource={profiles}\n            grid={{\n              gutter: 16,\n              xs: 1,\n              sm: 2,\n              md: 3,\n              lg: 3,\n              xl: 3,\n              xxl: 3\n            }}\n            style={{ padding: \"10px\" }}\n            renderItem={profile => (\n              <List.Item onClick={() => this.openProfileDrawer(profile._id)}>\n                <Skeleton avatar title={false} loading={profile.loading} active>\n                  <Card hoverable title={profile.companyName} bordered={false}>\n                    <b>{profile.primaryLocation}</b> <br />\n                    {/* <b>\n                          {moment(enquiry.eventDate).format(\"DD MMM, YYYY\")}\n                        </b>\n                        <br />\n                        Bought by: <b>\n                          {enquiry.interestedPartners.length}/5\n                        </b>{\" \"}\n                        vendors\n                        <Meta\n                          description={\n                            \"Posted: \" +\n                            moment(enquiry.createdAt).from(moment(Date.now()))\n                          }\n                          style={{\n                            paddingTop: \"10px\",\n                            textAlign: \"right\",\n                            position: \"relative\"\n                          }}\n                        /> */}\n                  </Card>\n                </Skeleton>\n              </List.Item>\n            )}\n          />\n\n          <style jsx>{`\n            a {\n              text-decoration: none;\n            }\n          `}</style>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Form.create({ name: \"manage-profile\" })(AdminManageProfile);\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAgBA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AACA;AAmCA;AACA;AAEA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AACA;AAGA;AACA;AACA;AAAA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AADA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAQA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAEA;AAEA;AADA;AACA;AAEA;AACA;AAGA;AAGA;AACA;AAEA;AACA;AAEA;AAKA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AADA;AACA;AAEA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AA7IA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AACA;;;AACA;AAEA;;;AAwHA;AAAA;AACA;AADA;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAFA;AADA;AADA;AAQA;AACA;A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","sourceRoot":""}