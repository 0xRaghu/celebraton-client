const express = require("express");
const compression = require("compression");
const next = require("next");
const axios = require("axios");
const dev = process.env.NODE_ENV !== "production";
const app = next({ dev });
const sm = require("sitemap");
const handle = app.getRequestHandler();

var http = require("http");
setInterval(function() {
  http.get("http://celebraton.herokuapp.com");
  http.get("http://celebraton-server.herokuapp.com");
}, 300000); // every 5 minutes (300000)

app.prepare().then(() => {
  const server = express();
  server.use(compression());
  server.get("/admin/adminDashboard", (req, res) => {
    return handle(req, res);
  });
  server.get("/dashboard", (req, res) => {
    return handle(req, res);
  });
  server.get("/vendor-login", (req, res) => {
    return handle(req, res);
  });
  server.get("/profile/:slug", (req, res) => {
    const actualPage = "/profile";
    const queryParams = { profileId: req.params.slug };
    app.render(req, res, actualPage, queryParams);
  });

  server.get("/sitemap.xml", function(req, res) {
    let urls = [
      { url: "/", changefreq: "daily", priority: 1.0 },
      { url: "/vendor-login", changefreq: "monthly", priority: 0.3 }
    ];
    const response = res;
    let categories;
    const chennaiLocalities = [
      "adambakkam",
      "adyar",
      "alandur",
      "alapakkam",
      "alwarpet",
      "alwarthirunagar",
      "ambattur",
      "aminjikarai",
      "annanagar",
      "annanur",
      "arumbakkam",
      "ashoknagar",
      "avadi",
      "ayanavaram",
      "besantnagar",
      "basinbridge",
      "chepauk",
      "chetpet",
      "chintadripet",
      "chitlapakkam",
      "choolai",
      "choolaimedu",
      "chrompet",
      "egmore",
      "ekkatuthangal",
      "ennore",
      "foreshoreestate",
      "georgetown",
      "gopalapuram",
      "guindy",
      "iitmadras",
      "injambakkam",
      "icf",
      "iyyappanthangal",
      "jafferkhanpet",
      "karapakkam",
      "kottivakkam",
      "kazhipattur",
      "kknagar",
      "keelkattalai",
      "kelambakkam",
      "kilpauk",
      "kodambakkam",
      "kodungaiyur",
      "kolathur",
      "korattur",
      "korukkupet",
      "kottivakkam",
      "kotturpuram",
      "kottur",
      "kovalam",
      "kovilambakkam",
      "koyambedu",
      "kundrathur",
      "madhavaram",
      "madipakkam",
      "madambakkam",
      "maduravoyal",
      "manali",
      "manapakkam",
      "mandaveli",
      "mangadu",
      "mannady",
      "mathur",
      "medavakkam",
      "meenambakkam",
      "minjur",
      "mogappair",
      "mkbnagar",
      "mountroad",
      "moolakadai",
      "moulivakkam",
      "mugalivakkam",
      "mudichur",
      "mylapore",
      "nandanam",
      "nanganallur",
      "navalur",
      "neelankari",
      "nesapakkam",
      "nolambur",
      "nungambakkam",
      "otteri",
      "padi",
      "pakkam",
      "palavakkam",
      "pallavaram",
      "pallikaranai",
      "pakkam",
      "parktown",
      "parrys",
      "pattabiram",
      "pattaravakkam",
      "pazhavanthangal",
      "perambur",
      "perumbakkam",
      "perungalathur",
      "perungudi",
      "poonamallee",
      "porur",
      "pudupet",
      "pulianthope",
      "purasaivakkam",
      "puzhal",
      "puzhuthivakkam",
      "ramavaram",
      "redhills",
      "royapettah",
      "royapuram",
      "saithapet",
      "saligramam",
      "santhome",
      "sembakkam",
      "selaiyur",
      "shenoynagar",
      "sholavaram",
      "sholinganallur",
      "sithalapakkam",
      "sowcarpet",
      "tambaram",
      "teynampet",
      "taramani",
      "tnagar",
      "tirumangalam",
      "thirumullaivoyal",
      "thiruneermalai",
      "thiruninravur",
      "tiruvanmiyur",
      "thiruverkadu",
      "thiruvotriyur",
      "tirusulam",
      "tiruvallikeni",
      "tiruvallur",
      "thondiarpet",
      "vandalur",
      "vadapalani",
      "valasaravakkam",
      "vallalarnagar",
      "vanagaram",
      "velachery",
      "villivakkam",
      "virugambakkam",
      "vyasarpadi",
      "washermenpet",
      "westmambalam"
    ];
    const bangaloreLocalities = [
      "madiwala",
      "sarjapurroad",
      "electroniccity",
      "ecity",
      "jpnagar",
      "koramangala",
      "devanahalli",
      "kanakapuraroad",
      "cvramannagar",
      "jalahalli",
      "ramamurthynagar",
      "dollarscolony",
      "gmpalya",
      "frasertown",
      "basavanagar",
      "hoskote",
      "lavelleroad",
      "hanumanthnagar",
      "sarjapur",
      "mathikere",
      "rajajinagar",
      "banaswadi",
      "thippasandra",
      "horamavu",
      "ombrlayout",
      "rmvextension",
      "tumkur",
      "mahadevapura",
      "aecslayout",
      "kanakanagar",
      "basaveshwaranagar",
      "sanjaynagar",
      "rbilayout",
      "millersroad",
      "shantinagar",
      "naganathapura",
      "coxtown",
      "itpl",
      "nagwar",
      "vijayanagar",
      "magadiroad",
      "dodballapurroad",
      "basavanagudi",
      "cookestown",
      "sadaramangala",
      "vasanthnagar",
      "hmtlayout",
      "silkboard",
      "bommasandra",
      "prashanthnagar",
      "vidyanagar",
      "chambalriver",
      "whitefield",
      "hsrlayout",
      "hosurroad",
      "yelahanka",
      "marathahalli",
      "anekal",
      "kalyannagar",
      "hrbrlayout",
      "brookefield",
      "abbigere",
      "kundalahalli",
      "chandapur",
      "nagarbhavi",
      "chamarajpet",
      "kodigehalli",
      "akshayanagar",
      "hegdenagar",
      "resthouseroad",
      "mgroad",
      "uttarahalli",
      "banashankari",
      "krpuram",
      "mysoreroad",
      "richmondroad",
      "rajarajeshwarinagar",
      "chikkaballapur",
      "hulimavu",
      "hoskote",
      "palaceroad",
      "huskur",
      "hebbal",
      "kempapura",
      "yeshwantpur",
      "ulsoor",
      "doddaballapur",
      "attibelle",
      "kengeri",
      "nelamangala",
      "outerringroad",
      "malleshpalaya",
      "anjanapura",
      "wilsongarden",
      "nagawara",
      "nandihills",
      "pailayout",
      "hennur",
      "bilekahalli",
      "indraprastha",
      "bannerghattaroad",
      "jayanagar",
      "indiranagar",
      "hesarghatta",
      "hennurroad",
      "rtnagar",
      "btmlayout",
      "jakkur",
      "rajanukunte",
      "gottigere",
      "balandur",
      "richardstown",
      "chikkajala",
      "thanisandra",
      "jiganiindustrialarea",
      "begurroad",
      "hbrlayout",
      "bagalur",
      "bommanahalli",
      "kasturinagar",
      "vidyaranyapura",
      "malleshwaram",
      "defencecolony",
      "thyagarajnagar",
      "kumaraswamylayout",
      "kudlugate",
      "hoodivillage",
      "vijayabanklayout",
      "tippasandra",
      "jeevanbimanagar",
      "bensontown",
      "kaggadaspura",
      "padmanabhanagar",
      "peenay",
      "sahakarnagar",
      "vigyannagar",
      "bellaryroad",
      "majestic",
      "isrolayout",
      "ganganagar",
      "sadaramangala",
      "rajbhavan",
      "manekchowk"
    ];
    const hyderabadLocalities = [
      "gachibowli",
      "shamshabad",
      "kukatpally",
      "mallapur",
      "hitechcity",
      "habsiguda",
      "jubileehills",
      "secunderabad",
      "banjarahills",
      "manikonda",
      "uppalkalan",
      "ameerpet",
      "shamirpet",
      "sainikpuri",
      "srinagarcolony",
      "quthbullapur",
      "acguards",
      "asroanagar",
      "abidsroad",
      "adarshnagar",
      "adikmet",
      "afzalgunj",
      "agapura",
      "ahmednagar",
      "akbarroad",
      "alexanderroad",
      "aliabad",
      "alwal",
      "amberpet",
      "amberpet",
      "anandbagh",
      "anandbagh",
      "ashoknagar",
      "asifnagar",
      "attapur",
      "attapurringroad",
      "autonagar",
      "azamabad",
      "azampuramasjid",
      "baberbagh",
      "bachpally",
      "badichowdi",
      "baghamberpet",
      "baghamberpet",
      "bahadurpura",
      "bahadurpura",
      "bahadurpura",
      "bakaram",
      "balanagar",
      "balapur",
      "balkampet",
      "bandimet",
      "bandlaguda",
      "bankstreet",
      "bansilalpet",
      "bapujinagar",
      "barkas",
      "barkatpura",
      "barkatpura",
      "barkatpura",
      "begumbazar",
      "bhagyanagarcolony",
      "bharatnagar",
      "bhel",
      "bholakpur",
      "bkguda",
      "boduppal",
      "boggulakunta",
      "bolaram",
      "borabanda",
      "boudhanagar",
      "bowenpally",
      "boyiguda",
      "chaderghat",
      "chaitanyapuri",
      "champapet",
      "champapetxroad",
      "chanchalguda",
      "chandanagar",
      "chandrayanagutta",
      "chappelbazar",
      "chappelroad",
      "charkaman",
      "charlapally",
      "charminar",
      "chattabazar",
      "cherlapally",
      "chikkadpally",
      "chilkalguda",
      "chintal",
      "chintalbasti",
      "chintalkunta",
      "chiragalilane",
      "chudibazar",
      "ddcolony",
      "dabeerpura",
      "dabeerpuranorth",
      "darulsalam",
      "darulshifa",
      "defencecolony",
      "devandevdi",
      "dhanbazar",
      "dharamkaranroad",
      "diamondpoint",
      "dilshadnagar",
      "dilsukhnagarmainroad",
      "distilleryroad",
      "domalguda",
      "doodhbowli",
      "dwarkapuricolony",
      "eastanandbagh",
      "eastmarredpally",
      "ecilxroads",
      "edibazarnorth",
      "erragadda",
      "erramanzil",
      "esamiabazar",
      "falaknuma",
      "fatehdarwaza",
      "fatehmaidan",
      "fatehnagar",
      "feelkhana",
      "ferozguda",
      "filmnagar",
      "gaddiannaram",
      "gaganmahal",
      "gaganpahad",
      "gandhinagar",
      "gandhipet",
      "gandhipetroad",
      "generalbazar",
      "ghansibazar",
      "ghasmandi",
      "ghasmandi",
      "golconda",
      "goshamahal",
      "gowliguda",
      "gowligudachaman",
      "greenlands",
      "greenparkextension",
      "gudimalkapur",
      "gudimalkapurnewpo",
      "gulzarhouse",
      "gunfoundry",
      "gunrock",
      "gunfoundry",
      "hafizpet",
      "hakimpet",
      "hanumantekdi",
      "haribowli",
      "hasmatpet",
      "hastinapuram",
      "hayatnagar",
      "hillfort",
      "hillstreet",
      "himayatnagar",
      "himayatsagar",
      "hmtnagar",
      "humayunnagar",
      "hussainialam",
      "hyderbasti",
      "hydernagar",
      "hyderabadcentral",
      "hyderguda",
      "ibrahimbagh",
      "ibrahimpatnam",
      "inderbagh",
      "indirapark",
      "jagadgirigutta",
      "jagdishmarket",
      "jahanuma",
      "jambagh",
      "jamiaosmania",
      "jawaharnagar",
      "jawaharlalnehruroad",
      "jeedimetla",
      "kachi",
      "kachiguda",
      "kakaguda",
      "kakatiyanagar",
      "kalasiguda",
      "kalikabar",
      "kalikaman",
      "kalyannagar",
      "kamalanagar",
      "kamalapuricolony",
      "kamlanagar",
      "kamlanagar",
      "kandojibazar",
      "kapra",
      "karimnagar",
      "karkhana",
      "karmanghat",
      "karvan",
      "kavadiguda",
      "keshavagiri",
      "khairatabad",
      "kharkhanamainroad",
      "kharkhanamainroad",
      "kishanbagh",
      "kishangunj",
      "kompally",
      "kompally",
      "kothaguda",
      "kothapet",
      "kphb",
      "krishnanagar",
      "kukatpallycolony",
      "kummarguda",
      "kundanbagh",
      "kushaiguda",
      "kattedan",
      "kavadiguda",
      "lbnagar",
      "ladbazar",
      "lakdikapul",
      "lalbazar",
      "laldarwaza",
      "lalapet",
      "lallaguda",
      "langerhouse",
      "lingampalli",
      "lothukunta",
      "lowertankbundroad",
      "mgroad",
      "machilikaman",
      "madannapet",
      "madhapur",
      "madhuranagar",
      "madina",
      "madinaguda",
      "mahankalistreet",
      "maharajgunj",
      "mahendrahills",
      "mahendrahills",
      "malakpetextension",
      "malkajgiri",
      "mallapur",
      "mallapuram",
      "mallepally",
      "mangalhat",
      "marredpally",
      "maruthicolony",
      "masabtank",
      "medchal",
      "meerpet",
      "mehboobgunj",
      "mettuguda",
      "ministerroad",
      "miralammandi",
      "miyapur",
      "mogulpura",
      "moinabad",
      "moosabowli",
      "nagarjunahills",
      "nagole",
      "nampally",
      "narayanguda",
      "nehrunagar",
      "newnallakunta",
      "nizampet",
      "paradise",
      "putlibowli",
      "ramnagar",
      "rethibowli",
      "safilguda",
      "saleemnagar",
      "serilingampally",
      "shivarampally",
      "somajiguda",
      "sultanbazar",
      "tankbund",
      "tilaknagar",
      "uppal",
      "yousufguda"
    ];
    const mumbaiLocalities = [
      "Agripada",
      "Airindiastaffcolony",
      "Airoli",
      "Airolisector4",
      "Airolisector8",
      "Ambarnath",
      "Ambarnatheast",
      "Ambernathwest",
      "Ambewadi",
      "Amboli",
      "Andheri",
      "Antophill",
      "Apollobunder",
      "Augustkrantimaidan",
      "Azadnagar",
      "Badlapur",
      "Ballardestate",
      "Bandra",
      "Bandraeast",
      "Bandrawest",
      "Belapur",
      "Bhandup",
      "Bhandupeast",
      "Bhandupwest",
      "Bharatnagar",
      "Bhayandar",
      "Bhayandareast",
      "Bhayandarwest",
      "Bhayander",
      "Bhiwandi",
      "Bhoiwada",
      "Boisar",
      "Boisarwest",
      "Borivali",
      "Breachcandy",
      "Byculla",
      "Bycullaeast",
      "Bycullawest",
      "Cbdbelapursector11",
      "Chandivali",
      "Chembur",
      "Chembureast",
      "Chemburwest",
      "Chinchpokli",
      "Chinchpoklieast",
      "Chinchpokliwest",
      "Chirabazaar",
      "Chowpatti",
      "Churchgate",
      "Cuffeparade",
      "Cumbalahill",
      "Dadar",
      "Dadareast",
      "Dadartt",
      "BorivaliEast",
      "Dadarwest",
      "Dahisareast",
      "Dahisarwest",
      "Danabunder",
      "Danda",
      "Deonar",
      "Deonareast",
      "Dharavi",
      "Dhobhitalao",
      "Dhobitalao",
      "Dombivali",
      "Dombivalieast",
      "Dombivaliwest",
      "Fort",
      "Gamdevi",
      "Ghansoli",
      "Ghatkopar",
      "Ghatkopareast",
      "Ghatkoparwest",
      "Girgaon",
      "Girgaonchowpatty",
      "Goregaoneast",
      "Goregaoneast",
      "Goregaonwest",
      "Goregaonwest",
      "Goregoan",
      "Govandi",
      "Govandieast",
      "Govandiwest",
      "Governmentcolony",
      "Gowaliatank",
      "Grantroad",
      "Grantroadeast",
      "Grantroadwest",
      "Greenparkextension",
      "Irla",
      "Jbnagar",
      "Jacobcircle",
      "Jogeshwari",
      "Jogeshwarieast",
      "Jogeshwariwest",
      "Juhu",
      "Juhuscheme",
      "Kalaghoda",
      "Kalamboli",
      "Kalbadevi",
      "Kalwa",
      "Kalwawest",
      "Kalyan",
      "Kalyaneast",
      "Kalyanwest",
      "Kamothe",
      "Kandivali",
      "Kandivalieast",
      "Colaba",
      "Kandivaliwest",
      "Kanjurmargeast",
      "Kanjurmargwest",
      "Kanjurmarg",
      "Kanjurmargeast",
      "Kanjurmargwest",
      "Kempscorner",
      "Ketkipada",
      "Khar",
      "Khardanda",
      "Khareast",
      "Kharwest",
      "Kharghar",
      "Khargharsector12",
      "Khargharsector2",
      "Khargharsector7",
      "Khetwadi",
      "Khopoli",
      "Kidwainagar",
      "Koparkhairane",
      "Kurlaeast",
      "Kurlawest",
      "Lalbaug",
      "Loharchawl",
      "Lokhandwala",
      "Lowerpareleast",
      "Lowerparelwest",
      "Mahalaxmi",
      "Mahape",
      "Mahim",
      "Mahimeast",
      "Mahimwest",
      "Malabarhill",
      "Malad",
      "Maladwest",
      "Marinelines",
      "Mazagaon",
      "Naigaon",
      "Navimumbai",
      "Oshiwara",
      "Panvel",
      "Parel",
      "Prabhadevi",
      "Santacruz",
      "Seepz",
      "Tardeo",
      "Thakurdwar",
      "Vakola",
      "Vesava",
      "Vileparle",
      "Wadala",
      "Worli",
      "BorivaliWest",
      "AndheriEast",
      "AndheriWest"
    ];
    const puneLocalities = [
      "AmbegaonBudruk",
      "Anandnagar",
      "Aundh",
      "AundhRoad",
      "BalajiNagar",
      "Baner",
      "Banerroad",
      "BhandarkarRoad",
      "BhavaniPeth",
      "Bibvewadi",
      "Bopodi",
      "BudhwarPeth",
      "BundGardenRoad",
      "Camp",
      "ChandanNagar",
      "Dapodi",
      "DeccanGymkhana",
      "DehuRoad",
      "Dhankawadi",
      "DhayariPhata",
      "DholePatilRoad",
      "Erandwane",
      "FatimaNagar",
      "FergussonCollegeRoad",
      "GaneshPeth",
      "Ganeshkhind",
      "GhorpadePeth",
      "Ghorpadi",
      "GokhaleNagar",
      "Gultekdi",
      "Guruwarpeth",
      "Hadapsar",
      "HadapsarIndustrialEstate",
      "HingneKhurd",
      "JangaliMaharajRoad",
      "KalyaniNagar",
      "KarveNagar",
      "KarveRoad",
      "KasbaPeth",
      "Katraj",
      "Khadaki",
      "Khadki",
      "Kharadi",
      "Kondhwa",
      "KondhwaBudruk",
      "KondhwaKhurd",
      "KoregaonPark",
      "Kothrud",
      "LawCollegeRoad",
      "LaxmiRoad",
      "LullaNagar",
      "MahatmaGandhiRoad",
      "Mangalwarpeth",
      "ManikBagh",
      "Marketyard",
      "Modelcolony",
      "MukundNagar",
      "Mundhawa",
      "NagarRoad",
      "NanaPeth",
      "NarayanPeth",
      "Narayangaon",
      "NaviPeth",
      "Padmavati",
      "ParvatiDarshan",
      "Pashan",
      "PaudRoad",
      "Pirangut",
      "PrabhatRoad",
      "PuneRailwayStation",
      "RastaPeth",
      "RaviwarPeth",
      "SadashivPeth",
      "SahakarNagar",
      "SalunkeVihar",
      "SassonRoad",
      "SataraRoad",
      "SenapatiBapatRoad",
      "ShaniwarPeth",
      "ShivajiNagar",
      "ShukrawarPeth",
      "SinhagadRoad",
      "SomwarPeth",
      "Swargate",
      "TilakRoad",
      "UruliDevachi",
      "VadgaonBudruk",
      "WadgaonSheri",
      "VimanNagar",
      "VishrantWadi",
      "Wagholi",
      "Wakadewadi",
      "Wanowrie",
      "Warje",
      "Yerawada",
      "Yerawada"
    ];
    const delhiLocalities = [
      "AbulFazalEnclave",
      "AdarshNagar",
      "ArdeeCity",
      "AjmereGate",
      "AkbarRoad",
      "Alaknanda",
      "AmanVihar",
      "AmarColony",
      "AmarVihar",
      "AmbedkarNagar",
      "AmbikaVihar",
      "AmritKaurMarket",
      "Amritpuri",
      "AnandParbat",
      "AnandVihar1",
      "Anandlok",
      "AnkurColony",
      "AramNagar",
      "ArjunNagar",
      "AryaNagar",
      "AsafAliRoad",
      "AshokPark",
      "AshokVihar",
      "AurangzeebMarg",
      "AzadNagarEast",
      "AzadNagarWest",
      "AzadNagar",
      "BabaNagar",
      "BabarpurWest",
      "Babarpur",
      "Badli",
      "BahadurShahZafarMarg",
      "BajajEnclave",
      "BaliNagar",
      "BaljitNagar",
      "BanarsiDasEstate",
      "BapaNagar",
      "BaraHinduRao",
      "Bawana",
      "BegamVihar",
      "Begampur",
      "BerSarai",
      "BhagatSinghColony",
      "BhagawanNagar",
      "BhagirathiVihar",
      "Bhajanpura",
      "BhalswaDairy",
      "BharatNagar",
      "BharatiColony",
      "BhartiNagar",
      "BhimNagarGurgaon",
      "BheraEnclave",
      "BhikajiCamaPlace",
      "Bhopura",
      "BholaNathNagar",
      "Bijwasan",
      "BihariColony",
      "BlockAJanakpuri",
      "BlockBJankpuri",
      "BlockCJankpuri",
      "BrahmPuri",
      "Brijpuri",
      "BrijVihar",
      "BudhVihar",
      "BulandshahrRoadIndustrialArea",
      "CanalColony",
      "ChanakyaPlace",
      "Chanakyapuri",
      "ChandniChowk",
      "ChandBag",
      "Chakkarpur",
      "ChanderNagar",
      "ChanderLok",
      "ChandraLokColony",
      "ChanderVihar",
      "ChauhanBangar",
      "Chandrawal",
      "Chawla",
      "ChiranjeevVihar",
      "Chhatarpur",
      "Chhajjupur",
      "ChunaMandi",
      "Dallupura",
      "Dashrathpuri",
      "DayanandColony",
      "DeepakVihar",
      "DeepVihar",
      "DefenceColony",
      "DelhiGate",
      "DeoliExtention",
      "DerawalNagar",
      "DhaulaKuan",
      "DayaBasti",
      "DayanandNagar",
      "DilkhushBagh",
      "DilkhushBaghIndustrialArea",
      "DilshadColony",
      "DilshadPlaza",
      "DiplomaticEnclave",
      "DlfAnkurVihar",
      "DlfPhaseIII",
      "DlfPhaseIV",
      "DlfPhaseV",
      "Dundahera",
      "Dr.ZakhirHussainRoad",
      "DwarkaSubCityMap",
      "EastKrishnaNagar",
      "FriendsColonyEast",
      "GaganVihar",
      "Gamri",
      "GandhiVihar",
      "GandhiNagar",
      "GandhiNagar1",
      "GaneshNagar",
      "GangaVihar",
      "GautamNagar",
      "GautamVihar",
      "Gautampuri",
      "GeetaColony",
      "Gharoli",
      "GharoliDairyFarm",
      "Ghazipur",
      "GiriNagar",
      "Ghonda",
      "Gokalpur",
      "Govindpura",
      "Govindpuri",
      "GreaterKailash",
      "GreaterKailash-2",
      "GreenPark",
      "GtbEnclave",
      "GtKarnalIndustrialArea",
      "GuruTegBahadurNagar",
      "GuruGovindSinghMarg",
      "GuruHarkrishanNagar",
      "GuruNanakNagar",
      "HakikatNagar",
      "HarkeshNagar",
      "HariNagar",
      "HindanVihar",
      "HiraNagar",
      "HauzKhas",
      "HauzKhazEnclave",
      "Himmatpuri",
      "InaColony",
      "InderEnclave",
      "Inderlok",
      "Inderpuri",
      "IndiaGate",
      "IndraEnclave",
      "IndraNagar",
      "IndraPark",
      "IndraVihar",
      "IndraprasthaExtent",
      "IndraprasthaMarg",
      "IpEstate",
      "Islampur",
      "Jaffarabad",
      "JamaMasjid",
      "Jharera",
      "JanakPark",
      "Jangpura",
      "JantaColony",
      "Jasola",
      "Jatwara",
      "JeevanNiketan",
      "Jhandewalan",
      "Jhangirpuri",
      "JharodaMajraBurar",
      "JhilmilColony",
      "JhilmilIndustrialArea",
      "JheelKhurenja",
      "JoshiColony",
      "Kailashpuri",
      "Kalkaji",
      "KalindiColony",
      "KalindiKunja",
      "KailashNagar",
      "Kallupura",
      "KalkajiExtention",
      "KalyanVihar",
      "Kalyanpuri",
      "KamlaMarket",
      "KamlaNagar",
      "Kanhai",
      "KhandsaRoad",
      "KirtiNagarExtension",
      "KirtiNagarIndustrialArea",
      "KishanGanj",
      "KrishnaNagar",
      "Krishnapuri",
      "KrishnaVihar",
      "KanjhawalaRoad",
      "Kapashera",
      "Karampura",
      "KaranViharPhase2",
      "KaranViharPhase1",
      "KarolBagh",
      "KarawalNagar",
      "Karkarduma",
      "KartarNagar",
      "KashmiriGate",
      "Kathwara",
      "KasturbaNagar",
      "KatwariaSarai",
      "Kaushambi",
      "Keshavpuram",
      "Keshopur",
      "KewalPark",
      "KhajuriKhas",
      "Khanpur",
      "Khelgaon",
      "Khizarabad",
      "KhoraColony",
      "Khyala",
      "KhyberPass",
      "Kilokri",
      "KingswayCamp",
      "KirpalBagh",
      "KiranVihar",
      "KirariVillage",
      "LajpatRaiMarket",
      "LalBagh",
      "LaxmanVihar",
      "LalKuan",
      "LodhiRoad",
      "LodhiColony",
      "LodhiEstate",
      "LoniRoad",
      "Madangir",
      "MadanpurDabas",
      "MadhubanEnclave",
      "MadhuVihar",
      "Madipur",
      "Madanpuri",
      "MaharaniBagh",
      "MahindraPark",
      "Mahipalpur",
      "MahipalpurExtention",
      "MandakiniEncalve",
      "MaharaniEnclave",
      "MaharaniEnclave1",
      "MaharaniEnclave2",
      "MahendraEnclave",
      "MahipalpurVillage",
      "MajlisPark",
      "ManakViharExtention",
      "MandakaniVillage",
      "Mandaoli",
      "MandaoliExtention",
      "MangolpurKalan",
      "Mangolpuri",
      "MangolpuriIndustrialAreaPhase1",
      "MangolpuriIndustrialAreaPhase2",
      "ManoharPark",
      "MangolpurKhurd",
      "MansarovarGarden",
      "MansarovarPark",
      "Maujpur",
      "MauriceNagar",
      "MayaEnclave",
      "MayapuriIndlAreaPhase1",
      "MayurViharPhase1Extention",
      "MayurViharPhase1",
      "MayurViharPhase2",
      "Mehrauli",
      "MikandVihar",
      "MilapNagar",
      "MiyanwaliNagar",
      "ModelTown",
      "MohanGarden",
      "MohitNagar",
      "MoolChandNagar",
      "MoriGate",
      "MotiBaghNorth",
      "Motiakhan",
      "MotiBaghSouth",
      "MotiNagar",
      "MubarakpurDabas",
      "MukundNagar",
      "MukandVihar",
      "Munirka",
      "Mustfabad",
      "Naharpur",
      "NaiSarak",
      "NajafgarhRoadIndustrialArea",
      "NandNagri",
      "Nandgram",
      "NathuColony",
      "NawabGanj",
      "NazarAli",
      "NebSarai",
      "NehruVihar",
      "NehruRoad",
      "NewAryaNagar",
      "NewColony",
      "NewIndustrialTownship",
      "NewKondli",
      "NewRailwayRoad",
      "NihalVihar",
      "NirmanVihar",
      "NitholiExtention",
      "NittiVihar",
      "Nizammudin",
      "NoidaLinkRoad",
      "Okhla",
      "OkhlaIndlArea",
      "OkhlaIndlEstate",
      "OkhlaVihar",
      "OldMustfabad",
      "OldGurgaonRoad",
      "OldRohtakRoad",
      "OldSeemapuri",
      "OldSlumQuarters",
      "OldSubziMandi",
      "OmVihar",
      "Palam",
      "PalamVihar",
      "Pasaunda",
      "PaschimViharExten",
      "PaschimVihar",
      "Paschimpuri",
      "PatelGarden",
      "PatelMarg",
      "Patparganj",
      "PatparganjIndustrialArea",
      "PiraGarhi",
      "PiraGariReliefCamp",
      "PragatiVihar",
      "PrahladVihar",
      "PratapNagar",
      "PreetVihar",
      "PremNagar",
      "PriyaDarshaniVihar",
      "PriyaEnclave",
      "PunjabiBaghEast",
      "PunjabiBaghWest",
      "PuranaQuilaRoad",
      "PusaInstitute",
      "Pulpehladpur",
      "PushpVihar",
      "Pushpanjali",
      "PushtaRoad",
      "PuthKalan",
      "QutabInstiArea",
      "RaceCourseRoad",
      "RaghubirNagar",
      "RaispurVillage",
      "RailwayRoad",
      "RajaGarden",
      "RajanVihar",
      "RajNagar",
      "RajeevNagar",
      "RajendraNagar",
      "RajendraPlace",
      "RajgarhColony",
      "RameshNagar",
      "Rampuri",
      "Rangpuri",
      "RaniJhansiRoad",
      "RaniBagh",
      "Rk-Puram-Sector10-12",
      "Rohini-Extention",
      "RohiniInstitutiona",
      "RohiniSector3",
      "SabhapurVillage",
      "SadarBazar",
      "SadatPur",
      "SaddiqNagar",
      "SafdarjangEnclave",
      "Sagarpur",
      "SagarpurWest",
      "SainikNagar",
      "Saket",
      "Samaipur",
      "SangamPark",
      "SanjayColony",
      "SanjayGandhiTransportNagar",
      "SanjayNagar",
      "SantNagar",
      "SaraiJullena",
      "SaraiNagar",
      "SatyaNiketan",
      "SaraiRohilla",
      "SaraswatiVihar",
      "SaritaVihar",
      "SarojiniNagar",
      "SarvapriyaVihar",
      "SarvodayaEnclave",
      "SbiColony",
      "Sector-2-Noida",
      "Sector5Noida",
      "Sector-12-Noida",
      "Sector-14-Noida",
      "Sector-14a-Noida",
      "Sector-18-Noida",
      "Sector-19-Noida",
      "Sector-22-Noida",
      "Sector-23-Noida",
      "Sector-24-Noida",
      "Sector-25-Noida",
      "Sector-26-Noida",
      "Sector-35-Noida",
      "Sector40Noida",
      "Sector41Noida",
      "Sector50Noida",
      "Sector51Noida",
      "Sector52Noida",
      "Sector53Noida",
      "Sector54Noida",
      "Sector-56-Noida",
      "Sector-57-Noida",
      "Sector-58-Noida",
      "Sector-1-Dwarka",
      "Sector-2-Dwarka",
      "Sector-3-Dwarka",
      "Sector-4-Dwarka",
      "Sector-5-Dwarka",
      "Sector-6-Dwarka",
      "Sector-7-Dwarka",
      "Sector-8-Dwarka",
      "Sector-9-Dwarka",
      "Sector-10-Dwarka",
      "Sector-11-Dwarka",
      "Sector-12-Dwarka",
      "Sector-13-Dwarka",
      "Sector-14-Dwarka",
      "Sector-16a-Dwarka",
      "Sector-16c-Dwarka",
      "Sector-16d-Dwarka",
      "Sector-17-Dwarka",
      "Sector-18a-Dwarka",
      "Sector-18-Dwarka",
      "Sector-19-Dwarka",
      "Sector-20-Dwarka",
      "Sector-21-Dwarka",
      "Sector-23-Dwarka",
      "Sector-24-Dwarka",
      "Sector19Faridabad",
      "Sector27bFaridabad",
      "Sector27cFaridabad",
      "Sector28Faridabad",
      "Sector47Faridabad",
      "Sector-2-Nehru-Nagar-Ghaziabd",
      "Sector-20-Ghaziabad",
      "Sector-21-Ghaziabad",
      "Sector1Gurgaon",
      "Sector2Gurgaon",
      "Sector3Gurgaon",
      "Sector3aGurgaon",
      "Sector4Gurgaon",
      "Sector6Gurgaon",
      "Sector8Gurgaon",
      "Sector9Gurgaon",
      "Sector9aGurgaon",
      "Sector10aGurgaon",
      "Sector-12-Gurgaon",
      "Sector-13-Gurgaon",
      "Sector16Gurgaon",
      "Sector17Gurgaon",
      "Sector18Gurgaon",
      "Sector-19-Gurgaon",
      "Sector21Gurgaon",
      "Sector22Gurgaon",
      "Sector-23-Gurgaon",
      "Sector28Gurgaon",
      "Sector-29-Gurgaon",
      "Sector30Gurgaon",
      "Sector31Gurgaon",
      "Sector32Gurgaon",
      "Sector33Gurgaon",
      "Sector37Part2Gurgaon",
      "Sector38Gurgaon",
      "Sector39Gurgaon",
      "Sector40Gurgaon",
      "Sector41Gurgaon",
      "Sector42Gurgaon",
      "Sector44Gurgaon",
      "Sector45Gurgaon",
      "Sector-46-Gurgaon",
      "Sector53Gurgaon",
      "Sector-5-Pushp-Vihar",
      "Sector-7-Pushp-Vihar",
      "Sector2RkPuram",
      "Sector-5-Rk-Puram",
      "Sector-12-Rk-Puram",
      "Sector-13-Rk-Puram",
      "Sector3RajendraNagar",
      "Sector4RajendraNagar",
      "Sector-5-Rajendra-Nagar",
      "Sector1RohiniAvantika",
      "Sector-3-Rohini",
      "Sector4Rohini",
      "Sector5Rohini",
      "Sector6Rohini",
      "Sector-7-Rohini",
      "Sector8Rohini",
      "Sector9Rohini",
      "Sector11Rohini",
      "Sector-12-Rohini",
      "Sector-13-Rohini",
      "Sector-14-Rohini",
      "Sector-15-Rohini",
      "Sector16Rohini",
      "Sector17Rohini",
      "Sector20Rohini",
      "Sector20RohiniExtension",
      "Sector21Rohini",
      "Sector22Rohini",
      "Sector-23-Rohini",
      "Sector24Rohini",
      "Sector-25-Rohini",
      "Sector1PushpaVihar",
      "Sector5Vasundhara",
      "Sector6Vasundhara",
      "Sector10Vasundhara",
      "Sector11Vasundhara",
      "Sector-12-Vasundhara",
      "Sector-14-Vasundhara",
      "Sector16Vasundhara",
      "Sector7RamakrishnaPuram",
      "Sector8RamakrishnaPuram",
      "Sector9RamakrishnaPuram",
      "ShahjhanRoad",
      "Shakurbasti",
      "ShakurpurColony",
      "ShalimarGardenExtention1",
      "ShankarRoad",
      "ShastriMarg",
      "SheikhSaraiPhase1",
      "SheikhSaraiPhase2",
      "ShivVihar",
      "ShivajiMarg",
      "ShivaniEnclave",
      "Shivpuri",
      "ShraddhanandMarg",
      "ShreeNagar",
      "ShresthaVihar",
      "Shriniwaspuri",
      "SikandarpurGhosi",
      "SouthCity",
      "SouthCity1",
      "SuryaVihar",
      "SushantLok",
      "SouthExtension2",
      "SubhashNagar",
      "SubhashVihar",
      "SukhdevVihar",
      "Sultanpuri",
      "SunderNagar",
      "SunderVihar",
      "SunlightColony",
      "SurajVihar",
      "SurajmalVihar",
      "SuryaNagar",
      "SwasthyaVihar",
      "TagoreGarden",
      "TaimoorNagar",
      "TajpurPahari",
      "Tatarpur",
      "TilakMarg",
      "TilakNagar",
      "TriNagar",
      "Trilokpuri",
      "TughlakabadExtention",
      "Tukmirpur",
      "UdyogNagar",
      "UdyogViharPhaseIIIIII",
      "UdyogViharPhaseIVV",
      "UttamNagar",
      "UttariPitampura",
      "VasantVihar",
      "VedVihar",
      "VigyanLok",
      "VijayNagar",
      "VijayPark",
      "VikasNagar",
      "VikasPuri",
      "VikramEnclaveExt",
      "VinayMarg",
      "VivekanandNagar",
      "WazirpurIndustrial",
      "YamunaVihar",
      "Zakhira"
    ];
    const ahmedabadLocalities = [
      "Ambawadi",
      "Amraiwadi",
      "Asarwa",
      "AshramRoad",
      "Aslali",
      "Astodia",
      "Bapunagar",
      "Bardolpura",
      "Behrampura",
      "Bhadra",
      "Bodakdev",
      "Bopal",
      "CGRoad",
      "Chandkheda",
      "Chandlodia",
      "Changodar",
      "CTM",
      "CTMCharRasta",
      "DaniLimbada",
      "Dariapur",
      "DelhiChakla",
      "DelhiDarwaja",
      "DriveInRoad",
      "Dudheshwar",
      "DudheshwarRoad",
      "EllisBridge",
      "GandhiRoad",
      "GeetaMandir",
      "GeetaMandirRoad",
      "Ghatlodia",
      "Gheekanta",
      "GheekantaRoad",
      "Ghodasar",
      "Gomtipur",
      "Gota",
      "GulbaiTekra",
      "Gurukul",
      "Hatkeshwar",
      "IncomeTax",
      "Isanpur",
      "Jamalpur",
      "Jasodanagar",
      "JivrajPark",
      "Jodhpur",
      "Juhapura",
      "JunaWadaj",
      "Kalupur",
      "Kankaria",
      "KankariaRoad",
      "Kathwada",
      "Khadia",
      "Khamasa",
      "Khanpur",
      "Khokhara",
      "Krishnanagar",
      "KuberNagar",
      "Madhupura",
      "ManekChowk",
      "Maninagar",
      "MeghaniNagar",
      "Memnagar",
      "Mirzapur",
      "MirzapurRoad",
      "Naranpura",
      "Naroda",
      "NarodaGIDC",
      "Narodaroad",
      "Narol",
      "NavaWadaj",
      "NavarangpuraGam",
      "Nikol",
      "NirnayNagar",
      "Odhav",
      "OdhavGIDC",
      "OdhavRoad",
      "Paldi",
      "PankoreNaka",
      "Patharkuva",
      "PattharKuva",
      "Raipur",
      "Rakhial",
      "Ranip",
      "RannaPark",
      "RatanPole",
      "RevdiBazaar",
      "Sabarmati",
      "SahijpurBogha",
      "Sarangpur",
      "Saraspur",
      "SardarNagar",
      "Sarkej",
      "SarkhejGandhinagarHighway",
      "Satellite",
      "SatelliteRoad",
      "ShahAlamRoad",
      "Shahibagh",
      "ShahibaugRoad",
      "Shahpur",
      "Sola",
      "SolaRoad",
      "SubhashBridge",
      "Tavdipura",
      "TeenDarwaja",
      "ThakkarbapaNagar",
      "Thaltej",
      "Usmanpura",
      "Vasna",
      "Vastral",
      "Vastrapur",
      "Vatva",
      "VatvaGIDC",
      "Vejalpur"
    ];
    const goaLocalities = [
      "Chimbel",
      "Arpora",
      "Fatorda",
      "Caranzalem",
      "vagator",
      "Utorda",
      "Candolim",
      "Colva",
      "Benaulim",
      "Anjuna",
      "Miramar",
      "Borda",
      "Margao",
      "Varca",
      "Sancoale",
      "Panjim",
      "Porvorim",
      "Calangute",
      "Bogmalo",
      "Majorda",
      "DonaPaula",
      "Dabolim",
      "Aldona",
      "Baga",
      "Mapusa",
      "Nuvem",
      "Chaudi",
      "Agonda",
      "Canacona",
      "Morjim",
      "Sirvoi",
      "Siolim",
      "Moira",
      "SantaInez",
      "Pilerne",
      "Taleigao",
      "VascodaGama",
      "Betalbatim",
      "Raia",
      "Saligao",
      "Nerul",
      "Sernabatim",
      "Olim",
      "Qupem",
      "Margao-ColvamainRoad",
      "SaoJoseDeAreal",
      "Guirim",
      "Palolem",
      "ReisMagos",
      "Tiswadi",
      "Bambolim",
      "Assagao",
      "Ponda",
      "VelhaGoa",
      "Bainguinim",
      "Corlim",
      "ChogumRoad",
      "Carmona",
      "Curti",
      "Soccoro",
      "Ucassaim",
      "Davorlim",
      "Velsao",
      "Bardez",
      "Cavelossim",
      "Merces",
      "Verem",
      "KadambaPlateau",
      "Nachinola",
      "Navelim",
      "Mormugao",
      "Chicalim",
      "AirportRoad",
      "Chapora",
      "Ribandar",
      "Chorao",
      "Maina",
      "GoaVelha",
      "Bicholim",
      "Cortalim",
      "Mollem",
      "Chandor",
      "Sangolda",
      "Quelossim",
      "Loutolim",
      "Nagoa",
      "Aquem",
      "Tonca",
      "Mardol",
      "Orgao",
      "Verla",
      "Mandrem",
      "Bandoli",
      "Revora",
      "Tamboxem",
      "Curchorem",
      "Cuncolim",
      "Salem",
      "Curca",
      "Colvale",
      "Alto-BetimPorvorim",
      "Tivim",
      "Curtorim",
      "Torxem",
      "Assolna",
      "Assonora",
      "Carambolim",
      "Marra",
      "Arambol",
      "Pernem",
      "Verna",
      "Sanquelim",
      "Shiroda",
      "Vengurla",
      "Rivona",
      "Mandur",
      "Vanelim",
      "Sircaim",
      "Xeldem",
      "Colem",
      "Arossim",
      "VodlemolCacora",
      "Dramapur",
      "Cunchelim",
      "Sasoli",
      "AltoPorvorim",
      "Siridao",
      "Issorcim",
      "NewVaddem",
      "Gancim",
      "Seraulim",
      "Piedade",
      "VerlaCanca",
      "VidhyanagarColony",
      "Salcete"
    ];
    //pull profile etc for sitemap
    axios.defaults.baseURL = "https://celebraton-server.herokuapp.com";
    // axios.defaults.baseURL = "http://localhost:5000";
    axios
      .get(`/api/profiles/allProfiles`)
      .then(profiles => {
        profiles.data.map(profile =>
          urls.push({ url: `/profile/${profile.slug}` })
        );
      })
      .then(res => {
        axios
          .get(`/api/categories/allCategories/50/0`)
          .then(categories => {
            categories = categories.data;
            axios.get(`/api/admin/getLocations`).then(locations => {
              const loc = locations.data[0].locations;
              loc.map(location => {
                categories.map(category =>
                  urls.push({ url: `/${category.slug}_in_${location}` })
                );
              });
            });
          })
          .then(res => {
            axios
              .get(`/api/categories/allCategories/50/0`)
              .then(categories => {
                categories = categories.data;
                chennaiLocalities.map(location => {
                  categories.map(category =>
                    urls.push({ url: `/${category.slug}_in_${location}` })
                  );
                });
              })
              .then(res => {
                axios
                  .get(`/api/categories/allCategories/50/0`)
                  .then(categories => {
                    categories = categories.data;
                    bangaloreLocalities.map(location => {
                      categories.map(category =>
                        urls.push({
                          url: `/${category.slug}_in_${location}`
                        })
                      );
                    });
                  })
                  .then(res => {
                    axios
                      .get(`/api/categories/allCategories/50/0`)
                      .then(categories => {
                        categories = categories.data;
                        hyderabadLocalities.map(location => {
                          categories.map(category =>
                            urls.push({
                              url: `/${category.slug}_in_${location}`
                            })
                          );
                        });
                      })
                      .then(res => {
                        axios
                          .get(`/api/categories/allCategories/50/0`)
                          .then(categories => {
                            categories = categories.data;
                            mumbaiLocalities.map(location => {
                              categories.map(category =>
                                urls.push({
                                  url: `/${category.slug}_in_${location}`
                                })
                              );
                            });
                          })
                          .then(res => {
                            axios
                              .get(`/api/categories/allCategories/50/0`)
                              .then(categories => {
                                categories = categories.data;
                                puneLocalities.map(location => {
                                  categories.map(category =>
                                    urls.push({
                                      url: `/${category.slug}_in_${location}`
                                    })
                                  );
                                });
                              })
                              .then(res => {
                                axios
                                  .get(`/api/categories/allCategories/50/0`)
                                  .then(categories => {
                                    categories = categories.data;
                                    delhiLocalities.map(location => {
                                      categories.map(category =>
                                        urls.push({
                                          url: `/${
                                            category.slug
                                          }_in_${location}`
                                        })
                                      );
                                    });
                                  })
                                  .then(res => {
                                    axios
                                      .get(`/api/categories/allCategories/50/0`)
                                      .then(categories => {
                                        categories = categories.data;
                                        ahmedabadLocalities.map(location => {
                                          categories.map(category =>
                                            urls.push({
                                              url: `/${
                                                category.slug
                                              }_in_${location}`
                                            })
                                          );
                                        });
                                      })
                                      .then(res => {
                                        axios
                                          .get(
                                            `/api/categories/allCategories/50/0`
                                          )
                                          .then(categories => {
                                            categories = categories.data;
                                            goaLocalities.map(location => {
                                              categories.map(category =>
                                                urls.push({
                                                  url: `/${
                                                    category.slug
                                                  }_in_${location}`
                                                })
                                              );
                                            });
                                          })

                                          .then(res => {
                                            //Create instance of sitemap
                                            const sitemap = sm.createSitemap({
                                              hostname:
                                                "https://www.celebraton.in",
                                              cacheTime: 600000, // 600 sec - cache purge period
                                              urls: urls
                                            });
                                            sitemap.toXML(function(err, xml) {
                                              if (err) {
                                                console.log(err);
                                              }
                                              response.header(
                                                "Content-Type",
                                                "application/xml"
                                              );
                                              response.send(xml);
                                            });
                                          });
                                      });
                                  });
                              });
                          });
                      });
                  });
              });
          });
      });
  });

  server.get("/dialogflow", (req, res, next) => {
    // this.unblock();
    // var obj=JSON.stringify(req);
    // console.log(EJSON.fromJSONValue(req.queryResult),EJSON.stringify(req.queryResult));
    // var obj=EJSON.fromJSONValue(req);
    // var obj2=EJSON.stringify(req);
    // console.log(obj.queryResult);
    var elasticemail = require("elasticemail");
    var client = elasticemail.createClient({
      username: "admin@celebraton.in",
      apiKey: "4110245d-e1d2-4944-ac43-52bd0d720c2b"
    });

    var msg = {
      from: "admin@celebraton.in",
      from_name: "CelebratON.in",
      to: "admin@celebraton.in",
      subject: "New Enquiry/contact form from the Bot",
      body_html: "Check in dialogflow history"
    };

    client.mailer.send(msg, function(err, result) {
      if (err) {
        return console.error(err);
      }
    });
    return {
      fulfillmentText:
        "Thanks a lot. You will receive a call from our representative soon. \nHappy Celebrating !!"
    };
  });

  server.get("/:category", (req, res) => {
    if (req.path.includes("in")) {
      const split = req.path.split("_in_");
      const actualPage = "/category";
      const queryParams = { enquiry: split[0].substring(1) + "-" + split[1] };
      app.render(req, res, actualPage, queryParams);
    } else {
      return handle(req, res);
    }
  });

  server.get("*", (req, res) => {
    return handle(req, res);
  });

  server.listen(process.env.PORT || 3000, err => {
    if (err) throw err;
    console.log("> Ready on http://localhost:3000");
  });
});
